import e from"lodash";var n,t,r;!function(e){e.Setting="setting",e.Translation="translation",e.UI="ui",e.Feature="feature"}(t||(t={})),function(e){e.Setting="settings",e.Translation="translations",e.UI="ui",e.Feature="features"}(r||(r={}));var o=((n={})[t.Setting]={plural:r.Setting,label:"Setting",labelPlural:"Settings",order:1},n[t.Translation]={plural:r.Translation,label:"Translation",labelPlural:"Translations",order:2},n[t.UI]={plural:r.UI,label:"UI",labelPlural:"UI",order:3},n[t.Feature]={plural:r.Feature,label:"Feature",labelPlural:"Features",order:4},n),i=e.assign,a=e.mapValues,u=function(e){return void 0===e&&(e={}),e=a(e,function(){return!0}),i({nested:!1,categorized:!1,sort:!1},e)},l=e.fromPairs,s=e.sortBy,c=e.toPairs,f=function(e){return l(s(c(e),0))},d=e.each,v=e.setWith,p=function(e){var n={};return d(e,function(e,t){v(n,t,e,Object)}),n},b=e.each,g=e.get,h=function(e,n,t){void 0===n&&(n={}),void 0===t&&(t=null);var r=u(n),i=e;return r.sort&&(i=f(i)),r.categorized&&(i=function(e,n){void 0===n&&(n=null);var t={};return b(e,function(e,r){if(n){var o=n(r,e),i=o.key,a=o.value;i&&(r=i),a&&(e=a)}t[r]=e}),t}(i,function(e){var n=g(t,e);return n&&(e=o[n.category].plural+"."+e),{key:e}})),r.nested?p(i):i},y=e.each,m=e.has,P=function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r={};return y(e,function(e,o){var i=m(e,"value")&&!t?e.value:e.default;if(n){var a=n(o,e),u=a.key,l=a.value;u&&(o=u),l&&(i=l)}r[o]=i}),r},O=function(e,n,t){void 0===n&&(n={}),void 0===t&&(t=!1);var r=u(n),i=P(e,function(e,n){return{key:e=r.categorized?o[n.category].plural+"."+e:e}},t);return r.nested?p(i):i},w=e.differenceWith,k=e.each,j=e.fromPairs,C=e.has,I=e.isEqual,L=e.pickBy,F=e.toPairs,E=function(e,n){var t=j(w(F(n),F(e),I)),r=L(t,function(n,t){return!C(e,t)}),o=L(t,function(n,t){return C(e,t)}),i=j(w(F(e),F(n),I));return{added:r,changed:o,removed:L(i,function(e,t){return!C(n,t)})}},S=function(e,n){var t=E(e,n),r={};return k(t,function(n,o){k(t[o],function(n,t){r[t]={value:n,status:o,previous:e[t]}})}),r},T=function(){var e=process.memoryUsage(),n="Memory Usage\n";for(var t in e)n+=t+": "+Math.round(e[t]/1024/1024*100)/100+" MB\n";console.log(n)};function R(){return R=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},R.apply(this,arguments)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}function _(e,n){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},_(e,n)}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function z(e,n,t){return z=x()?Reflect.construct.bind():function(e,n,t){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(e,r));return t&&_(o,t.prototype),o},z.apply(null,arguments)}function M(e){var n="function"==typeof Map?new Map:void 0;return M=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return z(e,arguments,U(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_(t,e)},M(e)}var V=e.assign,W=e.each,B=e.get,q=e.has,D=e.includes,A=e.isObject,K=e.kebabCase,N=e.last,G=e.mapKeys,Z=e.mapValues,H=e.merge,J=e.set,Q=e.size,X=e.split,Y=e.startCase,$=e.unset,ee=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},ne=function(e,n,t){if(void 0===t&&(t=!1),A(n)){if(!t&&!q(n,"default")&&!q(n,"inherit"))throw new Error('Config "'+e+'" is missing a "default" value (or "inherit" reference).')}else n={default:n};return n},te=function(e,n,t){if(void 0===t&&(t={}),delete(n=ne(e,n)).key,n.docLink){var r='Documentation on this feature can be found <a href="'+n.docLink+'">here</a>.';n.hint=n.hint?r+"<br>"+n.hint:r,delete n.docLink}if(n.inherit){var o="When left blank, inherits value from <code>"+n.inherit+"</code>.";n.hint=n.hint?o+"<br>"+n.hint:o}return V({default:null,type:ee(n),label:Y(N(X(e,"."))),category:"setting"},n,t)},re=function(e,n,t){return void 0===n&&(n={}),e=G(e,function(e,n){return B(e,"key",n)}),Z(e,function(e,r){return t&&t(r,e),te(r,e,n)})},oe=function(e,n){return V({label:Y(N(X(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},n)},ie=function(e,n){var t={};return W(e,function(e){if(A(e)&&!q(e,"key"))throw new Error("Onboarder config missing key!");var r=A(e)?e.key:e;if(!q(n,r))throw new Error('Onboarder defines key "'+r+'" which does not exist.');t[r]=A(e)?V({},n[r],e):V({},n[r])}),t},ae=function(e,n){var t={};return W(e,function(e,r){t[r]={label:e.label?e.label:Y(r),configs:ie(e.configs,n)}}),t},ue=function(e){var n=e.getComponents,t=e.getConfigs,r=e.getLabel,o=e.getName,i=e.getOnboarders,a=e.source;try{var u=function(e){function o(r){function o(e){function n(){var e;W(e=a.configs,function(n,t){if(n.inherit&&!q(e,n.inherit))throw new Error('Config with key "'+t+'" has inherit property defined as "'+n.inherit+'" which is not a valid key!')});var n=function(){if(i)return Promise.resolve(i()).then(function(e){a.onboarders=function(e,n){var t={};return W(e,function(e,r){var o=e.getLabel,i=e.getTabs;t[r]={label:o?o():Y(r),tabs:i?ae(i(),n):{}}}),t}(e,a.configs)})}();return n&&n.then?n.then(function(){return a}):a}var r=function(){if(t)return Promise.resolve(t()).then(function(n){var t=re(n),r=function(e,n){void 0===n&&(n={});var t={},r=!1;return W(e,function(e){if("object"==typeof e&&q(e,"component")){if(!q(t,e.component)){var o={};if(q(n,e.component)){var i=n[e.component].getOptions;o=i?i():n[e.component]}t[e.component]=oe(e.component,o)}}else r=!0}),r&&Q(t)&&(t.unsorted=oe("unsorted",{order:999})),t}(t,e);H(a,{configs:t,components:r})});var n,r,o,i=(r={},o=function(e){return Z(e,function(e,n){var t=e.getOptions;return oe(n,t?t():null)})}(n=e),W(n,function(e,n){var t=function(e,t){void 0===t&&(t="setting");var i={component:n},a=function(e,n,t){void 0===t&&(t="setting");var r={group:{path:"groups"},tab:{path:"tabs"}},o=[],i=function(e,n){void 0===n&&(n=null);var t={};return W(e,function(e,r){if(e=ne(r,e),n){var o=n(r,e);t[o.key]=o.config}else t[r]=e}),t},a=function(e,n){return i(n,function(n,t){return"object"==typeof t&&(t.visibleIf&&(t.visibleIf=e+"."+t.visibleIf),t.longLabel=Y(e)+" ⇢ "+(t.longLabel?t.longLabel:t.label?t.label:Y(n))),{key:e+"."+n,config:t}})},u=function(a,u,l,s,c,f){return void 0===s&&(s=!0),void 0===c&&(c="group"),D(o,a)?console.warn('"'+a+'" group already exists in "'+t+'"'):o.push(a),function(t,o,i,a){void 0===a&&(a="group");var u=r[a].path,l={};W(i,function(t){if("object"==typeof t&&t.group){var o=t.group;W(r,function(t){var r=B(e,[n,t.path,o]);if(r){J(l,[t.path,o],r),$(e,[n,t.path,o]);var i=B(e,[n,t.path],{});0===Q(i)&&$(e,[n,t.path])}})}}),J(e,[n,u,t],V({label:o},l))}(a,u,l,c),i(l,function(e,n){return n.group=n.group?a+"."+n.group:a,f&&f(e,n),{key:s?a+"."+e:e,config:n}})};return{addNested:a,addFeature:function(e,n,t,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!0),q(t,"enabled"))throw new Error('Feature "'+e+'" should not contain a property named "enabled".');return t=V({enabled:ne("enabled",r)},t),u(e,n,t,o,"group",function(n,t){"enabled"!==n&&"object"==typeof t&&J(t,"visibleIf",e+".enabled")})},addGroup:u,addTab:function(e,n){var r=t+"-"+K(e);return u(r,e,n,!1,"tab")},addField:function(e,n){var t={},r=e+".isVisible",o=Y(e),i=o;return t.isVisible={default:!0,label:"Visible",longLabel:o+" ⇢ Visible",styleClasses:"col-md-2"},t.required={default:!1,label:"Required",longLabel:o+" ⇢ Required",visibleIf:r,styleClasses:"col-md-2"},t.disabled={default:!1,label:"Disabled",longLabel:o+" ⇢ Disabled",visibleIf:r,styleClasses:"col-md-2"},t.readonly={default:!1,label:"Readonly",longLabel:o+" ⇢ Readonly",visibleIf:r,styleClasses:"col-md-2"},t.hasAutoFocus={default:!1,label:"Autofocus",longLabel:o+" ⇢ Autofocus",visibleIf:r,styleClasses:"col-md-2"},t.pattern={default:"",label:"Pattern",longLabel:o+" ⇢ Pattern",visibleIf:r,styleClasses:"col-md-12"},n&&n&&n({insert:function(e,n){if(q(t,e))throw new Error("Field "+e+" already exists!");var i=te(e,n,{visibleIf:r,styleClasses:"col-md-12"});i.longLabel=o+" ⇢ "+i.label,t[e]=i},modify:function(e,n){H(t[e],ne(e,n,!0))},remove:function(e){delete t[e]},modifyLabel:function(e){i=e}}),u(e,i,t,!0)},addPluralized:function(e,n){var t={};if(n.zero&&(t[0]={default:n.zero,label:"Zero Case",hint:"When there are 0 items"}),n.one&&(t[1]={default:n.one,label:"One Case",hint:"When there is 1 item"}),n.many&&(t.other={default:n.many,label:"Many Case",hint:"When there are many items"}),Q(t))return a(e,t)}}}(o,n,t);t&&(i=V(i,{category:t}));var u=e(a);if(Q(u)){var l=B(o,[n,"categories"],[]);l.push(t),J(o,[n,"categories"],l),function(e,n,t){H(e,function(e,n,t){return re(n,t,function(n){if(q(e,n))throw new Error('Duplicate key: "'+n+'"')})}(e,n,t))}(r,u,i)}},i=e.getConfigs,a=e.getFeatures,u=e.getSettings,l=e.getTranslations,s=e.getUI;i?t(i):(u&&t(u,"setting"),l&&t(l,"translation"),s&&t(s,"ui"),a&&t(a,"feature"))}),{configs:r,components:o});H(a,{configs:i.configs,components:i.components})}();return r&&r.then?r.then(n):n()}var a={name:e,label:r};return n?Promise.resolve(n()).then(o):o(null)}return r?Promise.resolve(r()).then(o):o(Y(e))};return Promise.resolve(o?Promise.resolve(o()).then(u):u(a))}catch(e){return Promise.reject(e)}},le=/*#__PURE__*/function(e){var n,t;function r(n,t){var r;return(r=e.call(this,t.message+' ("'+n+'" source)')||this).name="SourceError",r}return t=e,(n=r).prototype=Object.create(t.prototype),n.prototype.constructor=n,_(n,t),r}(/*#__PURE__*/M(Error)),se=function(e,n){try{return Promise.resolve(ue(R({source:e},n))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}};export{o as CATEGORIES,t as ConfigCategory,r as ConfigCategoryPlurals,le as SourceError,S as getDiff,E as getDiffByStatus,u as getTransformationOptions,T as logMemoryUsage,ue as parseSource,se as parseSourceConfigs,f as sortObjectAlphabetically,P as transformFromConfigsToResponse,h as transformResponse,O as transformToConfigValues,p as transformToNested};
//# sourceMappingURL=index.module.mjs.map

import e from"lodash";var n,t,r;!function(e){e.Setting="setting",e.Translation="translation",e.UI="ui",e.Feature="feature"}(t||(t={})),function(e){e.Setting="settings",e.Translation="translations",e.UI="ui",e.Feature="features"}(r||(r={}));var o=((n={})[t.Setting]={plural:r.Setting,label:"Setting",labelPlural:"Settings",order:1},n[t.Translation]={plural:r.Translation,label:"Translation",labelPlural:"Translations",order:2},n[t.UI]={plural:r.UI,label:"UI",labelPlural:"UI",order:3},n[t.Feature]={plural:r.Feature,label:"Feature",labelPlural:"Features",order:4},n),i=e.assign,a=e.mapValues,u=function(e){return void 0===e&&(e={}),e=a(e,function(){return!0}),i({nested:!1,categorized:!1,sort:!1},e)},l=e.fromPairs,s=e.sortBy,c=e.toPairs,f=function(e){return l(s(c(e),0))},d=e.each,v=e.setWith,p=function(e){var n={};return d(e,function(e,t){v(n,t,e,Object)}),n},b=e.each,h=e.get,g=function(e,n,t){void 0===n&&(n={}),void 0===t&&(t=null);var r=u(n),i=e;return r.sort&&(i=f(i)),r.categorized&&(i=function(e,n){void 0===n&&(n=null);var t={};return b(e,function(e,r){if(n){var o=n(r,e),i=o.key,a=o.value;i&&(r=i),a&&(e=a)}t[r]=e}),t}(i,function(e){var n=h(t,e);return n?e=o[n.category].plural+"."+e:(console.warn("Non-existent key "+e+" is not part of the config set."),e="nonexistent."+e),{key:e}})),r.nested?p(i):i},y=e.each,m=e.get,w=e.has,P=function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r={};return y(e,function(o,i){o.inherit&&(o.default=m(e,o.inherit).default);var a=w(o,"value")&&!t?o.value:o.default;if(n){var u=n(i,o),l=u.key,s=u.value;l&&(i=l),s&&(a=s)}r[i]=a}),r},O=function(e,n,t){void 0===n&&(n={}),void 0===t&&(t=!1);var r=u(n),i=P(e,function(e,n){return{key:e=r.categorized?o[n.category].plural+"."+e:e}},t);return r.nested?p(i):i},k=e.differenceWith,j=e.each,I=e.fromPairs,C=e.has,L=e.isEqual,F=e.pickBy,T=e.toPairs,E=function(e,n){var t=I(k(T(n),T(e),L)),r=F(t,function(n,t){return!C(e,t)}),o=F(t,function(n,t){return C(e,t)}),i=I(k(T(e),T(n),L));return{added:r,changed:o,removed:F(i,function(e,t){return!C(n,t)})}},S=function(e,n){var t=E(e,n),r={};return j(t,function(n,o){j(t[o],function(n,t){r[t]={value:n,status:o,previous:C(e,t)?e[t]:null}})}),r},U=function(){var e=process.memoryUsage(),n="Memory Usage\n";for(var t in e)n+=t+": "+Math.round(e[t]/1024/1024*100)/100+" MB\n";console.log(n)};function _(){return _=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},_.apply(this,arguments)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function z(e,n){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},z(e,n)}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function W(e,n,t){return W=R()?Reflect.construct.bind():function(e,n,t){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(e,r));return t&&z(o,t.prototype),o},W.apply(null,arguments)}function M(e){var n="function"==typeof Map?new Map:void 0;return M=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return W(e,arguments,x(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),z(t,e)},M(e)}var V=e.assign,B=e.each,D=e.endsWith,q=e.get,A=e.has,N=e.includes,K=e.isObject,G=e.kebabCase,Z=e.last,H=e.mapKeys,J=e.mapValues,Q=e.merge,X=e.set,Y=e.size,$=e.split,ee=e.startCase,ne=e.unset,te=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},re=function(e,n,t){if(void 0===t&&(t=!1),K(n)){if(!t&&!A(n,"default")&&!A(n,"inherit"))throw new Error('Config "'+e+'" is missing a "default" value (or "inherit" reference).')}else n={default:n};return n},oe=function(e,n,t){if(void 0===t&&(t={}),n=re(e,n),ie(e,n),delete n.key,n.docLink){var r='Documentation on this feature can be found <a href="'+n.docLink+'">here</a>.';n.hint=n.hint?r+"<br>"+n.hint:r,delete n.docLink}if(n.inherit){var o="When unchanged, inherits value from <code>"+n.inherit+"</code>.";n.hint=n.hint?o+"<br>"+n.hint:o}return V({default:null,type:te(n),label:ee(Z($(e,"."))),category:"setting"},n,t)},ie=function(e,n){n.inputType||!D(e,"_id")&&!D(e,"ID")||""!==n.default&&null!==n.default&&N(["boolean","string"],typeof n.default)||console.warn('To remove this warning, set the "inputType" on "'+e+'" to "number" if its value is meant to be parsed as a number ("string" otherwise)')},ae=function(e,n,t){return void 0===n&&(n={}),e=H(e,function(e,n){return q(e,"key",n)}),J(e,function(e,r){return t&&t(r,e),oe(r,e,n)})},ue=function(e,n){return V({label:ee(Z($(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},n)},le=function(e,n){var t={};return B(e,function(e){if(K(e)&&!A(e,"key"))throw new Error("Onboarder config missing key!");var r=K(e)?e.key:e;if(!A(n,r))throw new Error('Onboarder defines key "'+r+'" which does not exist.');t[r]=K(e)?V({},n[r],e):V({},n[r])}),t},se=function(e,n){var t={};return B(e,function(e,r){t[r]={label:e.label?e.label:ee(r),configs:le(e.configs,n)}}),t},ce=function(e){var n=e.getComponents,t=e.getConfigs,r=e.getLabel,o=e.getName,i=e.getOnboarders,a=e.getOverrides,u=e.source;try{var l=function(e){function o(r){function o(e){function n(){function e(){var e=function(){if(a)return Promise.resolve(a()).then(function(e){u.overrides=e})}();return e&&e.then?e.then(function(){return u}):u}var n;B(n=u.configs,function(e,t){if(e.inherit&&!A(n,e.inherit))throw new Error('Config with key "'+t+'" has inherit property defined as "'+e.inherit+'" which is not a valid key!')});var t=function(){if(i)return Promise.resolve(i()).then(function(e){u.onboarders=function(e,n){var t={};return B(e,function(e,r){var o=e.getLabel,i=e.getTabs;t[r]={label:o?o():ee(r),tabs:i?se(i(),n):{}}}),t}(e,u.configs)})}();return t&&t.then?t.then(e):e()}var r=function(){if(t)return Promise.resolve(t()).then(function(n){var t=ae(n),r=function(e,n){void 0===n&&(n={});var t={},r=!1;return B(e,function(e){if("object"==typeof e&&A(e,"component")){if(!A(t,e.component)){var o={};if(A(n,e.component)){var i=n[e.component].getOptions;o=i?i():n[e.component]}t[e.component]=ue(e.component,o)}}else r=!0}),r&&Y(t)&&(t.unsorted=ue("unsorted",{order:999})),t}(t,e);Q(u,{configs:t,components:r})});var n,r,o,i=(r={},o=function(e){return J(e,function(e,n){var t=e.getOptions;return ue(n,t?t():null)})}(n=e),B(n,function(e,n){var t=function(e,t){void 0===t&&(t="setting");var i={component:n},a=function(e,n,t){void 0===t&&(t="setting");var r={group:{path:"groups"},tab:{path:"tabs"}},o=[],i=function(e,n){void 0===n&&(n=null);var t={};return B(e,function(e,r){if(e=re(r,e),n){var o=n(r,e);t[o.key]=o.config}else t[r]=e}),t},a=function(e,n){return i(n,function(n,t){return"object"==typeof t&&(t.visibleIf&&(t.visibleIf=e+"."+t.visibleIf),t.longLabel=ee(e)+" ⇢ "+(t.longLabel?t.longLabel:t.label?t.label:ee(n))),{key:e+"."+n,config:t}})},u=function(t,a,u,l,s,c){return void 0===l&&(l=!0),void 0===s&&(s="group"),N(o,t)||o.push(t),function(t,o,i,a){void 0===a&&(a="group");var u=r[a].path,l={};B(i,function(t){if("object"==typeof t&&t.group){var o=t.group;B(r,function(t){var r=q(e,[n,t.path,o]);if(r){X(l,[t.path,o],r),ne(e,[n,t.path,o]);var i=q(e,[n,t.path],{});0===Y(i)&&ne(e,[n,t.path])}})}}),X(e,[n,u,t],V({label:o},l))}(t,a,u,s),i(u,function(e,n){return n.group=n.group?t+"."+n.group:t,c&&c(e,n),{key:l?t+"."+e:e,config:n}})};return{addNested:a,addFeature:function(e,n,t,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!0),A(t,"enabled"))throw new Error('Feature "'+e+'" should not contain a property named "enabled".');return t=V({enabled:re("enabled",r)},t),u(e,n,t,o,"group",function(n,t){"enabled"!==n&&"object"==typeof t&&X(t,"visibleIf",e+".enabled")})},addGroup:u,addTab:function(e,n){var r=t+"-"+G(e);return u(r,e,n,!1,"tab")},addField:function(e,n){var t={},r=e+".isVisible",o=ee(e),i=o;return t.isVisible={default:!0,label:"Visible",longLabel:o+" ⇢ Visible",styleClasses:"col-md-2"},t.required={default:!1,label:"Required",longLabel:o+" ⇢ Required",visibleIf:r,styleClasses:"col-md-2"},t.disabled={default:!1,label:"Disabled",longLabel:o+" ⇢ Disabled",visibleIf:r,styleClasses:"col-md-2"},t.hasAutoFocus={default:!1,label:"Autofocus",longLabel:o+" ⇢ Autofocus",visibleIf:r,styleClasses:"col-md-2"},t.pattern={default:"",label:"Pattern",longLabel:o+" ⇢ Pattern",visibleIf:r,styleClasses:"col-md-12"},n&&n&&n({insert:function(e,n){if(A(t,e))throw new Error("Field "+e+" already exists!");var i=oe(e,n,{visibleIf:r,styleClasses:"col-md-12"});i.longLabel=o+" ⇢ "+i.label,t[e]=i},modify:function(e,n){Q(t[e],re(e,n,!0))},remove:function(e){delete t[e]},modifyLabel:function(e){i=e}}),u(e,i,t,!0)},addPluralized:function(e,n){var t={};if(n.zero&&(t[0]={default:n.zero,label:"Zero Case",hint:"When there are 0 items"}),n.one&&(t[1]={default:n.one,label:"One Case",hint:"When there is 1 item"}),n.many&&(t.other={default:n.many,label:"Many Case",hint:"When there are many items"}),Y(t))return a(e,t)}}}(o,n,t);t&&(i=V(i,{category:t}));var u=e(a);if(Y(u)){var l=q(o,[n,"categories"],[]);l.push(t),X(o,[n,"categories"],l),function(e,n,t){Q(e,function(e,n,t){return ae(n,t,function(n){if(A(e,n))throw new Error('Duplicate key: "'+n+'"')})}(e,n,t))}(r,u,i)}},i=e.getConfigs,a=e.getFeatures,u=e.getSettings,l=e.getTranslations,s=e.getUI;i?t(i):(u&&t(u,"setting"),l&&t(l,"translation"),s&&t(s,"ui"),a&&t(a,"feature"))}),{configs:r,components:o});Q(u,{configs:i.configs,components:i.components})}();return r&&r.then?r.then(n):n()}var u={name:e,label:r};return n?Promise.resolve(n()).then(o):o(null)}return r?Promise.resolve(r()).then(o):o(ee(e))};return Promise.resolve(o?Promise.resolve(o()).then(l):l(u))}catch(e){return Promise.reject(e)}},fe=/*#__PURE__*/function(e){var n,t;function r(n,t){var r;return(r=e.call(this,t.message+' ("'+n+'" source)')||this).name="SourceError",r}return t=e,(n=r).prototype=Object.create(t.prototype),n.prototype.constructor=n,z(n,t),r}(/*#__PURE__*/M(Error)),de=function(e,n){try{return Promise.resolve(ce(_({source:e},n))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}};export{o as CATEGORIES,t as ConfigCategory,r as ConfigCategoryPlurals,fe as SourceError,S as getDiff,E as getDiffByStatus,u as getTransformationOptions,U as logMemoryUsage,ce as parseSource,de as parseSourceConfigs,f as sortObjectAlphabetically,P as transformFromConfigsToResponse,g as transformResponse,O as transformToConfigValues,p as transformToNested};
//# sourceMappingURL=index.module.mjs.map
